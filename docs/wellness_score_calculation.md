# ウェルネススコア算出ロジック詳細

## 概要

ウェルネススコアは、企業の従業員の健康状態とエンゲージメントを総合的に評価するための指標です。このスコアは、Visual Analogue Scale（VAS）によるアンケートデータ、財務データ、業界特性、企業の成長段階などの多角的な情報を組み合わせて算出されます。

## データソース

ウェルネススコアの算出には、主に以下のデータソースが使用されます：

1. **VASアンケートデータ**
   - Google Formsなどを通じて収集された従業員の主観的評価
   - 労働環境、エンゲージメント、健康状態、リーダーシップ、コミュニケーションなどのカテゴリに分類
   - 10段階評価スケールを使用し、システム内部では100点満点に標準化

2. **財務データ**
   - 売上成長率、利益率、従業員一人当たりの収益など
   - 四半期または月次ベースで追跡
   - 業界平均との比較分析データ

3. **企業情報**
   - 業界（IT、ヘルスケア、金融など）
   - 成長段階（シード期、シリーズA、B、C、...）
   - 従業員数、創業年などの基本情報
   - 組織構造と発展段階の評価データ

## 算出プロセス

### 1. データ収集と前処理

1. **VASデータの収集**
   - `google_forms_vas_collector.py`によるGoogle Formsからのデータ収集
   - 回答形式の正規化（10段階評価を100点満点に変換など）
   - 時系列データとしての整理と異常値の検出

2. **データの前処理**
   - `data_preprocessor.py`による欠損値の処理
   - 異常値の検出と処理
   - 時系列データの整形
   - 業界・ステージ情報との統合

### 2. カテゴリごとのスコア計算

VASアンケートの質問は、以下のカテゴリに分類され、それぞれに重み付けが行われます：

| カテゴリ         | 重み  | 説明                                 | 主要評価項目 |
|--------------|-----|-------------------------------------|------------|
| work_environment | 25% | 職場環境の快適さ、施設、安全性など | 作業スペース、設備充実度、安全対策、騒音レベル |
| engagement      | 30% | 仕事への意欲、帰属意識、充実感など | 業務への集中度、やりがい、組織へのコミットメント |
| health          | 20% | 身体的・精神的健康状態 | 睡眠の質、ストレスレベル、身体的疲労度、メンタルヘルス |
| leadership      | 15% | 経営陣への信頼、ビジョンの共有など | 上司とのコミュニケーション、経営方針の明確さ |
| communication   | 10% | 情報共有の透明性、コミュニケーションの活発さなど | チーム内情報共有、部署間協力、フィードバック文化 |

各カテゴリのスコアは、対応する質問の回答を平均することで算出されます。この際、以下の特徴があります：

- **時間的重み付け**: より最近のデータほど高い重みを持つよう、指数関数的な重み付けを適用
- **データポイント不足の処理**: 特定のカテゴリのデータが不足している場合、デフォルト値（70点）を使用
- **回答頻度の最適化**: 週1〜2回程度の回答頻度を推奨し、過剰回答の場合は重み付けを調整

### 3. 基本スコアの計算

基本スコアは、各カテゴリのスコアを重み付け平均することで算出されます：

```
基本スコア =
  (work_environment * 0.25) +
  (engagement * 0.30) +
  (health * 0.20) +
  (leadership * 0.15) +
  (communication * 0.10)
```

この重み付けは、複数の産業心理学研究と組織開発理論に基づいて決定されており、特に「エンゲージメント」が最も高い重みを持つのは、従業員エンゲージメントと組織パフォーマンスの強い相関関係が複数の研究で実証されているためです（Gallup, 2022; Harvard Business Review, 2023）。

### 4. 調整要素の適用

基本スコアに対して、以下の調整要素が適用されます：

#### 4.1 財務相関による調整

財務指標とウェルネススコアの相関関係に基づく調整です：

- `correlation_analyzer.py`を使用して、VASデータと財務データの相関係数を計算
- 相関が強い（正の相関）ほど調整値は大きくなる
- 調整範囲は -5 ~ +5 点
- 最低3つのデータポイントが必要（不足する場合は調整なし）

#### 4.2 業界・ステージによる調整

業界特性と企業の成長段階に基づく調整です：

##### 業界係数（科学的根拠に基づく）

| 業界         | 係数  | 科学的根拠と説明                                 |
|--------------|-----|-------------------------------------|
| IT           | 1.0  | **標準基準値**: IT業界は比較的安定したストレスレベルを示すため、基準値として採用。複数業界横断調査において、IT業界は平均的なウェルネス指標を示している。 |
| Healthcare   | 1.05 | **根拠**: 研究データは、ヘルスケア産業が従業員の健康とウェルビーイングを高く重視する文化を持つことを示している。「The Growing Importance of Employee Health and Well-Being in Healthcare」（2021）では、COVID-19パンデミック期間中もヘルスケア職場が従業員ウェルビーイングプログラムを強化した傾向が報告されている。<br>**厳格評価の理由**: ウェルネスへの意識が高い環境では、より高い基準が期待されるため。 |
| Finance      | 0.95 | **根拠**: Perkboxの業界調査によると、金融セクターの従業員の69%が重大な仕事関連ストレスを報告しており、これは他産業平均より高い。「Work-Related Stress in the Banking Sector」研究では、長時間労働、競争圧力、職務不安定性がバンキングセクターの主要ストレス要因として特定されている。<br>**緩和評価の理由**: 構造的に高いストレス環境が存在するため。 |
| Manufacturing| 0.90 | **根拠**: 2022年の「Industrial Athlete Workforce Report」によると、製造業従業員の47%が職場でストレスを感じ、32%が仕事の結果として私生活に影響が出ていると報告。「Stress Management in Manufacturing Industries」では、物理的・化学的・人間工学的な労働環境が特有のストレス要因となることが確認されている。<br>**緩和評価の理由**: 物理的労働環境からくる独自のストレス要因を考慮。 |
| Retail       | 0.85 | **根拠**: 2022年の「Job Seeker Nation Report」では、小売業従業員の82%がストレスとバーンアウトの増加を報告し、これは全産業中最高レベル。NIOSHの調査では、不規則なシフト、長時間の立ち仕事、スタッフ不足、顧客対応が主要ストレス要因と特定されている（「Reducing Fatigue and Stress in the Retail Industry」）。<br>**最大緩和の理由**: 複合的なストレス要因と産業特性を考慮。 |
| Service      | 0.95 | **根拠**: 「SOURCES OF WORKPLACE STRESS IN SERVICE SECTOR ORGANISATIONS」研究では、サービス業従業員が顧客との直接対話、シフト労働、感情労働によるストレスを経験することが示されている。特に飲食業では時間帯による変動的プレッシャーがストレス要因となる（「Stress Management Techniques – Working in the Food Service Industry」）。<br>**緩和評価の理由**: 感情労働と人的要素によるストレスを考慮。 |
| Others       | 1.0  | **標準評価**: 特定のデータベースがないため、業界間比較の基準値として標準係数を適用。 |

##### ステージ係数（科学的根拠に基づく）

| 企業ステージ   | 係数  | 科学的根拠と説明                                 |
|--------------|-----|-------------------------------------|
| Seed         | 1.10 | **根拠**: 「Startup Working Hours: Burnout, Pacing, and Hustle Culture」研究では、シードステージの創業者・従業員が週平均70時間以上働く傾向があり、役割の曖昧さと多重責任がストレスを増大させることが示されている。リソース制約と市場不確実性も主要ストレス要因。<br>**最大緩和の理由**: 生存が最優先される環境でのストレス緩和が必要なため。 |
| Series A     | 1.05 | **根拠**: 「The 4 Stages of Small-Business Growth」によると、シリーズA企業は資金調達後も急成長に伴う組織的課題に直面する。組織構造の変化と役割の専門化が進むが、依然として高い不確実性が存在。<br>**緩和評価の理由**: 依然として高いストレス環境だが、リソース増加によりシード期よりは改善。 |
| Series B     | 1.00 | **根拠**: 「The Stages of a Startup」研究では、シリーズB段階でビジネスモデルが確立され、組織が安定化すると分析。市場検証と組織プロセスの確立によりストレス要因が標準化される傾向にある。<br>**標準評価の理由**: 安定性とストレス要因が平均的レベルに達するため基準値として設定。 |
| Series C     | 0.95 | **根拠**: シリーズC企業は組織構造が確立され、スケーリングに焦点が移る段階と位置づけられる（「The Stages of a Startup」）。プロセスの形式化と専門性の向上により、従業員の役割明確化が進み、労働環境の構造化が進む。<br>**厳格化の理由**: リソース増加と組織安定化に伴い、より高い基準が期待されるため。 |
| Series D+    | 0.90 | **根拠**: より後期段階の資金調達では、組織の成熟度が高まり、安定したプロセスと明確な役割分担が実現する。HBRの「The Five Stages of Small Business Growth」では、成熟企業では標準化されたプロセスが従業員のストレス軽減に貢献すると示されている。<br>**厳格化の理由**: リソース豊富な環境では高いウェルネス水準の達成が可能なため。 |
| IPO Ready    | 0.85 | **根拠**: IPO準備段階の企業は、公開市場の審査に耐えうる組織的成熟度が求められる。デロイトの「Human Capital Trends Report」では、上場準備企業は従業員ウェルビーイングプログラムの高度化が進むことが示されている。<br>**最大厳格化の理由**: 高い組織成熟度と資源によりウェルネス施策の実施能力が最大限に高まるため。 |

業界とステージの調整値は以下の式で計算されます：

```
調整値 = ((業界係数 * ステージ係数) - 1.0) * 10
```

この調整値の範囲は -5 ~ +5 点です。

#### 4.3 時系列トレンドによる調整

ウェルネススコアの時間的変化の傾向に基づく調整です：

- `time_series_analyzer.py`を使用して、スコアの上昇/下降トレンドを分析
- 上昇トレンドならプラス調整、下降トレンドならマイナス調整
- 調整範囲は -3 ~ +3 点
- 最低3つのデータポイントが必要（不足する場合は調整なし）

このトレンド分析には時系列データの統計的処理手法（移動平均、指数平滑法、ARIMA）が適用され、単なる直近の変動ではなく、持続的な傾向を捉えることを目的としています。

### 5. 最終スコアの計算

最終的なウェルネススコアは、基本スコアに各調整値を加えて算出されます：

```
最終スコア = 基本スコア + 財務相関調整 + 業界ステージ調整 + トレンド調整
```

最終スコアは0〜100の範囲に正規化されます。

## スコアの解釈

ウェルネススコアは以下のように解釈されます：

| スコア範囲    | 評価       | 説明                                 | 推奨アクション |
|------------|----------|-------------------------------------|-------------|
| 80-100     | 優良      | 非常に健全な組織文化と従業員ウェルネス状態 | 現状維持と好事例の文書化、他部門/企業への展開 |
| 60-79      | 良好      | 健全な組織文化だが、改善の余地がある | 弱点領域の特定と短期的改善計画の実施 |
| 40-59      | 要改善    | いくつかの重要な課題があり、改善が必要 | 詳細診断の実施と中期的改善計画の策定・実行 |
| 0-39       | 注意      | 深刻な問題があり、早急な対処が必要 | 緊急対応計画の作成と実行、経営層への報告と介入 |

## 技術的実装

ウェルネススコアの計算は、`backend/core/wellness_score_calculator.py`に実装されています。このモジュールは以下のクラスや機能を利用します：

- **データ処理**: `DataPreprocessor`
- **相関分析**: `CorrelationAnalyzer`
- **時系列分析**: `TimeSeriesAnalyzer`
- **データ保存**: `FirestoreService`

計算されたスコアは、Firestore内の以下の場所に保存されます：

- **スコア履歴**: `wellness_scores`コレクション
- **企業情報**: `companies`コレクションの各企業ドキュメント内

## VASデータ収集の連携

ウェルネススコア計算の基盤となるVASデータは、主にGoogle Formsを通じて収集されます。この連携は`backend/core/google_forms_vas_collector.py`に実装されており、以下の機能を提供します：

1. **Google Formsとの接続**: サービスアカウントを使用してAPIアクセス
2. **定期的なデータ収集**: スケジュールされたジョブによる自動収集
3. **データの変換**: フォーム回答からVASデータへの変換
4. **重複排除**: 前回収集時以降の新規回答のみを処理

### 10段階VASスケールの活用

Google Formsでは、以下の特性を持つ10段階VASスケールを使用しています：

- **スケール形式**: 1〜10の評価スケール（10が最高評価）
- **変換処理**: システム内部では100点満点に変換（×10倍）して保存
- **質問形式**: Google Formsのリニアスケール質問タイプを使用
- **回答の頻度**: 週1〜2回を推奨（高頻度回答の場合は重み付け調整）

## システムアーキテクチャ

ウェルネススコア計算システムは以下のコンポーネントで構成されています：

```
Google Forms API ←→ GoogleFormsConnector ←→ VASDataCollector ←→ WellnessScoreCalculator
                                              ↓                     ↓
                                       Firestore (vas_data)     Firestore (wellness_scores)
```

## 使用例

以下は、ウェルネススコア計算の使用例です：

```python
# ウェルネススコア計算機のインスタンス作成
calculator = create_wellness_score_calculator()

# 特定企業のウェルネススコアを計算
score_result = await calculator.calculate_wellness_score(
    company_id="company-123",
    industry="IT",
    stage="Series B"
)

# 結果の表示
print(f"総合スコア: {score_result['total_score']}")
print(f"カテゴリスコア: {score_result['category_scores']}")
print(f"調整要素: {score_result['adjustments']}")
```

## 今後の拡張性

ウェルネススコア計算システムは以下の拡張が可能です：

1. **新しい分析手法の追加**: ベイズ推論、機械学習モデルの統合
2. **外部データソースの追加**: 産業データ、経済指標との連携
3. **予測機能の強化**: 将来のウェルネス状態予測
4. **カスタム重み付け**: 企業ごとの固有の重み付け設定
5. **業界・ステージ係数の自動最適化**: 蓄積データに基づく定期的な係数更新

## 参考文献

- The Growing Importance of Employee Health and Well-Being in Healthcare (2021)
- Work-Related Stress in the Banking Sector: A Review of Incidence, Correlated Factors, and Major Consequences (2020)
- Stress Management in Manufacturing Industries (2022)
- Reducing Fatigue and Stress in the Retail Industry: Workplace solutions (2021)
- SOURCES OF WORKPLACE STRESS IN SERVICE SECTOR ORGANISATIONS (2019)
- The Five Stages of Small Business Growth (Harvard Business Review)
- Startup Working Hours: Burnout, Pacing, and Hustle Culture (2022)
- The Stages of a Startup: From Seed to IPO (2023)
- Gallup State of the Global Workplace Report (2022)
- Deloitte Human Capital Trends Report (2023)
- Industrial Athlete Workforce Report (2022)
- Job Seeker Nation Report (2022)