# FastAPIのエラー解決記録 - 初学者向け解説

## どんな問題が起きたの？

ブラウザで`http://localhost:8000`にアクセスしたとき、`{"detail": "Not Found"}`というエラーメッセージが表示されました。
これは「指定したURLのページが見つかりません」という意味です。

## なぜこの問題が起きたの？

大きく分けて3つの理由がありました：

1. **Dockerの起動方法の問題**
   - 私たちのアプリはDockerというコンテナの中で動いています
   - 最初の設定では、アプリの変更を検知して自動で再起動する機能（リロードモード）が無効でした
   - また、ログ（エラーメッセージなど）が見にくい設定になっていました

2. **URLの設定の問題**
   - FastAPIでは、URLと処理を結びつける必要があります（これをルーティングと呼びます）
   - 最初の設定では、この結びつけ方が複雑すぎて、うまく動作していませんでした
   - 例えば、`/api/vas/startup123`というURLにアクセスしても、対応する処理が見つからない状態でした

3. **データの形式チェックが厳しすぎた**
   - 返すデータの形式を厳密にチェックする設定になっていました
   - 開発中は少し緩めのチェックの方が、問題を見つけやすいです

## どうやって直したの？

1. **Dockerfileの修正**
   ```dockerfile
   # 変更前
   CMD ["python", "-m", "uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8000"]

   # 変更後
   ENV PYTHONUNBUFFERED=1
   CMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8000", "--reload"]
   ```
   - ログを見やすくする設定を追加（`PYTHONUNBUFFERED=1`）
   - コードを変更したら自動で再起動する設定を追加（`--reload`）

2. **URLの設定をシンプルに**
   ```python
   # 変更前：複雑な設定
   app = FastAPI()
   api_router = APIRouter()
   app.include_router(api_router, prefix="/api")

   # 変更後：シンプルな設定
   @app.get("/api/vas/{startup_id}")
   def get_vas_data(startup_id: str):
       # 処理の内容
   ```
   - URLと処理の結びつけをシンプルに書き直しました
   - これにより、どのURLがどの処理に対応するのか分かりやすくなりました

3. **データのチェックを一時的に緩和**
   - 開発中は厳密なチェックを外して、まず動くことを確認
   - 基本機能が動いてから、少しずつチェックを追加していく方針に変更

## 何を学んだ？

1. **シンプルに始めることの大切さ**
   - 最初から複雑な機能を入れようとせず、基本的な機能から作り始める
   - 動くことを確認してから、少しずつ機能を追加する

2. **エラーメッセージの重要性**
   - ログ設定を適切にして、エラーの内容を確認しやすくする
   - エラーメッセージを読んで、問題の箇所を特定する

3. **開発環境の整備**
   - コードの変更を即座に反映できる環境を整える
   - デバッグしやすい環境を作る

## これから何をするの？

1. **エラー処理の改善**
   - より分かりやすいエラーメッセージを表示する
   - エラーが起きたときの対処方法を記録する

2. **テストの追加**
   - 各機能が正しく動くかチェックするテストを作る
   - 新しい機能を追加したときに、既存の機能が壊れていないか確認する

3. **ドキュメントの作成**
   - APIの使い方を説明する文書を作る
   - 他の開発者が使いやすいように例を追加する